# 通用批处理的指导原则 #

下面是一些关键的指导原则,在构建批处理解决方案可以参考: 


- A batch architecture typically affects on-line architecture and vice versa. Design with both architectures and environments in mind using common building blocks when possible.
- Simplify as much as possible and avoid building complex logical structures in single batch applications.
- Process data as close to where the data physically resides as possible or vice versa (i.e., keep your data where your processing occurs).
- Minimize system resource use, especially I/O. Perform as many operations as possible in internal memory.
- Review application I/O (analyze SQL statements) to ensure that unnecessary physical I/O is avoided. In particular, the following four common flaws need to be looked for:
 	* Reading data for every transaction when the data could be read once and kept cached or in the working storage;
 	* Rereading data for a transaction where the data was read earlier in the same transaction;
 	* Causing unnecessary table or index scans;
 	* Not specifying key values in the WHERE clause of an SQL statement.

- 批架构通常会影响联机架构,反之亦然。设计时,这两种架构和环境,尽可能使用公共的构建块。
- 尽可能的简化,避免在单个批处理应用程序,构建复杂的逻辑结构。
- 处理数据尽可能靠近数据的物理位置,反之亦然(即。,让你的数据,你的处理)。
- 尽可能少的使用系统资源,尤其是I / O。尽可能多的在内存中执行许多操作。
- 回顾应用程序I / O(分析SQL语句)来确保避免不必要的物理I / O。特别是,以下四个常见的缺陷需要寻找:
	* 读取数据时,每笔交易的数据可以读取一次,保持缓存或工作存储;
	* 重读早些时候读数据事务的数据在同一事务;
	* 引起不必要的表或索引扫描;
	* 不指定键值在SQL语句的WHERE子句。


- Do not do things twice in a batch run. For instance, if you need data summarization for reporting purposes, increment stored totals if possible when data is being initially processed, so your reporting application does not have to reprocess the same data.
- Allocate enough memory at the beginning of a batch application to avoid time-consuming reallocation during the process.
- Always assume the worst with regard to data integrity. Insert adequate checks and record validation to maintain data integrity.
- Implement checksums for internal validation where possible. For example, flat files should have a trailer record telling the total of records in the file and an aggregate of the key fields.
- Plan and execute stress tests as early as possible in a production-like environment with realistic data volumes.
- In large batch systems backups can be challenging, especially if the system is running concurrent with on-line on a 24-7 basis. Database backups are typically well taken care of in the on-line design, but file backups should be considered to be just as important. If the system depends on flat files, file backup procedures should not only be in place and documented, but regularly tested as well.


- 不做事情在一个批处理运行两次。例如,如果你需要数据总结报告目的,增量存储总量,当开始处理数据时,如果可能,所以你的报告应用程序没有再处理相同的数据。
- 在一个批处理应用程序的开始分配足够的内存,以避免耗时的过程中重新分配。
- 总是假定最坏的关于数据的完整性。插入适当的检查和记录验证来维护数据完整性。
- 为内部实现校验和验证。例如,平面文件应该有一个尾记录,说明文件中的总记录数和一个聚合的关键字段。
- 尽可能早地计划和执行压力测试在产品环境下,使用真实的数据量。
- 在大型批量系统,备份将是一个挑战,特别是如果系统是一个7 x24小时联机并发运行时。数据库备份通常在线设计很好的照顾,但是文件备份应该被认为是同样重要。如果系统取决于平面文件,文件备份程序不仅应该和记录,但定期测试。

